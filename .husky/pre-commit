#!/bin/sh

echo "Running pre-commit checks..."

# Type-check (catches real code errors)
echo "Checking types..."
npx tsc --noEmit || {
  echo "TypeScript errors found. Fix before committing."
  exit 1
}

# Lint (catches code quality issues)
echo "Linting..."
npx next lint || {
  echo "Lint errors found. Fix before committing."
  exit 1
}

# Schema validation & feature health (catches missing tables/columns)
echo "Validating schema integrity..."
npx jest --testPathPatterns="schema-sql-validation|feature-health" --silent || {
  echo "Schema validation or feature health tests failed. Fix before committing."
  exit 1
}

echo "Pre-commit checks passed"
