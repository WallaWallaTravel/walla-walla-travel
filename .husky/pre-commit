#!/bin/sh

echo "Running pre-commit checks..."

# Load environment variables for prisma generate
if [ -f .env.local ]; then
  set -a
  . ./.env.local
  set +a
fi

# Generate Prisma client (needed for type-checking)
echo "Generating Prisma client..."
npx prisma generate || {
  echo "Prisma generate failed."
  exit 1
}

# Type-check (catches real code errors)
echo "Checking types..."
npx tsc --noEmit || {
  echo "TypeScript errors found. Fix before committing."
  exit 1
}

# Lint (catches code quality issues)
echo "Linting..."
npx next lint || {
  echo "Lint errors found. Fix before committing."
  exit 1
}

echo "Pre-commit checks passed"
